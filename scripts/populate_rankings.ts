
import fs from 'fs';
import path from 'path';

// Define the path to the universities file
const UNIV_FILE_PATH = path.join(__dirname, '../data/universities.ts');

// Fixed mapping of known rankings (based on QS/THE/National rankings 2024-2025)
const RANKING_MAP: Record<string, number> = {
    "–ù–∞–∑–∞—Ä–±–∞–µ–≤ –£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç—ñ": 1,
    "”ò–õ-–§–ê–†–ê–ë–ò –ê–¢–´–ù–î–ê“í–´ “ö–ê–ó–ê“ö “∞–õ–¢–¢–´“ö –£–ù–ò–í–ï–†–°–ò–¢–ï–¢–Ü": 2,
    "–ï–≤—Ä–∞–∑–∏–π—Å–∫–∏–π –Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –∏–º. –õ.–ù. –ì—É–º–∏–ª—ë–≤–∞": 3,
    "–ö–∞–∑–∞—Ö—Å–∫–∏–π –Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç": 4,
    "–ö–∞–∑–∞—Ö—Å–∫–∏–π –Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–µ–¥–∞–≥–æ–≥–∏—á–µ—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –∏–º–µ–Ω–∏ –ê–±–∞—è": 5,
    "–ö–∞–∑–∞—Ö—Å–∫–∏–π –Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∞–≥—Ä–∞—Ä–Ω—ã–π –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç": 6,
    "–Æ–∂–Ω–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –∏–º–µ–Ω–∏ –ú.–û. –ê—É—ç–∑–æ–≤–∞": 7,
    "–ö–∞–∑–∞—Ö—Å–∫–∏–π –Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –∏–º–µ–Ω–∏ –°.–î. –ê—Å—Ñ–µ–Ω–¥–∏—è—Ä–æ–≤–∞": 8,
    "–ê–ª–º–∞—Ç–∏–Ω—Å–∫–∏–π —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç": 9,
    "–ö–∞—Ä–∞–≥–∞–Ω–¥–∏–Ω—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –∏–º–µ–Ω–∏ –∞–∫–∞–¥–µ–º–∏–∫–∞ –ï.–ê. –ë—É–∫–µ—Ç–æ–≤–∞": 10,
    "–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–æ-–ë—Ä–∏—Ç–∞–Ω—Å–∫–∏–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç": 11,
    "–£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –ö–ò–ú–≠–ü": 12,
    "–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–π –∫–∞–∑–∞—Ö—Å–∫–æ-—Ç—É—Ä–µ—Ü–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –∏–º–µ–Ω–∏ –•.–ê. –Ø—Å–∞–≤–∏": 13,
    "–ö–∞–∑–∞—Ö—Å–∫–∏–π –∞–≥—Ä–æ—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –∏–º. –°.–°–µ–π—Ñ—É–ª–ª–∏–Ω–∞": 14,
    "–¢–æ—Ä–∞–π–≥—ã—Ä–æ–≤ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç": 15,
    "–ö–∞—Ä–∞–≥–∞–Ω–¥–∏–Ω—Å–∫–∏–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –∏–º–µ–Ω–∏ –ê–±—ã–ª–∫–∞—Å–∞ –°–∞–≥–∏–Ω–æ–≤–∞": 16,
    "–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π": 17,
    "–£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –ù–∞—Ä—Ö–æ–∑": 18,
    "–ú–ï–î–ò–¶–ò–ù–°–ö–ò–ô –£–ù–ò–í–ï–†–°–ò–¢–ï–¢ –ö–ê–†–ê–ì–ê–ù–î–´": 19,
    "–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –ê—Å—Ç–∞–Ω–∞": 20,
    "–°–µ–º–∏–ø–∞–ª–∞—Ç–∏–Ω—Å–∫–∏–π –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç": 21,
    "–ó–∞–ø–∞–¥–Ω–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∏–π –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –∏–º–µ–Ω–∏ –ú–∞—Ä–∞—Ç–∞ –û—Å–ø–∞–Ω–æ–≤–∞": 22,
    "–ö–∞–∑–∞—Ö—Å–∫–æ-–†—É—Å—Å–∫–∏–π –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π –£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç": 23,
    "–£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –∏–º–µ–Ω–∏ –°—É–ª–µ–π–º–∞–Ω–∞ –î–µ–º–∏—Ä–µ–ª—è": 24,
    "–ê–ª–º–∞—Ç—ã –ú–µ–Ω–µ–¥–∂–º–µ–Ω—Ç –£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç": 25,
    "Turan University": 26,
    "–ö–∞–∑–∞—Ö—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–π –∏ –º–∏—Ä–æ–≤—ã—Ö —è–∑—ã–∫–æ–≤ –∏–º–µ–Ω–∏ –ê–±—ã–ª–∞–π —Ö–∞–Ω–∞": 27,
    "–£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –ï—Å–µ–Ω–æ–≤–∞": 28,
    "–ê—Ç—ã—Ä–∞—É—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –Ω–µ—Ñ—Ç–∏ –∏ –≥–∞–∑–∞ –∏–º–µ–Ω–∏ –°–∞—Ñ–∏ –£—Ç–µ–±–∞–µ–≤–∞": 29,
    "–†—É–¥–Ω–µ–Ω—Å–∫–∏–π –∏–Ω–¥—É—Å—Ç—Ä–∏–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç–∏—Ç—É—Ç": 30,
    "–í–æ—Å—Ç–æ—á–Ω–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∏–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –∏–º–µ–Ω–∏ –î. –°–µ—Ä–∏–∫–±–∞–µ–≤–∞": 31,
    "–í–æ—Å—Ç–æ—á–Ω–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –∏–º–µ–Ω–∏ –°. –ê–º–∞–Ω–∂–æ–ª–æ–≤–∞": 32,
    "–°–µ–≤–µ—Ä–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –∏–º–µ–Ω–∏ –ú. –ö–æ–∑—ã–±–∞–µ–≤–∞": 33,
    "–ö–æ–∫—à–µ—Ç–∞—É—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –∏–º–µ–Ω–∏ –®. –£–∞–ª–∏—Ö–∞–Ω–æ–≤–∞": 34,
    "–ö–æ—Å—Ç–∞–Ω–∞–π—Å–∫–∏–π —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –∏–º–µ–Ω–∏ –ê. –ë–∞–π—Ç—É—Ä—Å—ã–Ω–æ–≤–∞": 35,
    "–ê–∫—Ç—é–±–∏–Ω—Å–∫–∏–π —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –∏–º–µ–Ω–∏ –ö. –ñ—É–±–∞–Ω–æ–≤–∞": 36,
    "–ö—ã–∑—ã–ª–æ—Ä–¥–∏–Ω—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –∏–º–µ–Ω–∏ –ö–æ—Ä–∫—ã—Ç –ê—Ç–∞": 37,
    "–¢–∞—Ä–∞–∑—Å–∫–∏–π —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –∏–º–µ–Ω–∏ –ú.–•. –î—É–ª–∞—Ç–∏": 38,
    "–ñ–µ—Ç—ã—Å—É—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –∏–º–µ–Ω–∏ –ò. –ñ–∞–Ω—Å—É–≥—É—Ä–æ–≤–∞": 39,
    "–ü–∞–≤–ª–æ–¥–∞—Ä—Å–∫–∏–π –ø–µ–¥–∞–≥–æ–≥–∏—á–µ—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç": 40,
    "–ö–∞–∑–∞—Ö—Å–∫–∞—è –Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∞–∫–∞–¥–µ–º–∏—è –∏—Å–∫—É—Å—Å—Ç–≤ –∏–º–µ–Ω–∏ –¢. –ñ—É—Ä–≥–µ–Ω–æ–≤–∞": 41,
    "–ö–∞–∑–∞—Ö—Å–∫–∞—è –Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–æ—Ä–∏—è –∏–º–µ–Ω–∏ –ö—É—Ä–º–∞–Ω–≥–∞–∑—ã": 42,
    "–ö–∞–∑–∞—Ö—Å–∫–∏–π –Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –∏—Å–∫—É—Å—Å—Ç–≤": 43,
    "–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–∞—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –∫–æ—Ä–ø–æ—Ä–∞—Ü–∏—è (–ö–∞–∑–ì–ê–°–ê)": 44,
    "–ê—Å—Ç–∞–Ω–∏–Ω—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç": 45,
    "–£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –ö–∞–∑–ì–Æ–£ –∏–º–µ–Ω–∏ –ú.–°. –ù–∞—Ä–∏–∫–±–∞–µ–≤–∞": 46,
    "–ö–∞—Å–ø–∏–π—Å–∫–∏–π –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç": 47,
    "–£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç '–¢—É—Ä–∞–Ω-–ê—Å—Ç–∞–Ω–∞'": 48,
    "–ï–≤—Ä–∞–∑–∏–π—Å–∫–∏–π –≥—É–º–∞–Ω–∏—Ç–∞—Ä–Ω—ã–π –∏–Ω—Å—Ç–∏—Ç—É—Ç": 49,
    "–ê–ª–º–∞—Ç–∏–Ω—Å–∫–∏–π –≥—É–º–∞–Ω–∏—Ç–∞—Ä–Ω–æ-—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç": 50
};

// Next tier rankings for unmapped universities
let nextRank = 51;

async function updateRankings() {
    console.log("üöÄ Starting ranking update...");

    if (!fs.existsSync(UNIV_FILE_PATH)) {
        console.error("‚ùå File not found:", UNIV_FILE_PATH);
        process.exit(1);
    }

    let content = fs.readFileSync(UNIV_FILE_PATH, 'utf-8');

    const lines = content.split('\n');
    let currentUniName = "";
    let updatedLines: string[] = [];
    let updatesCount = 0;

    for (let line of lines) {
        // Try to find name line
        const nameMatch = line.match(/"name":\s*"(.*?)"/);
        if (nameMatch) {
            currentUniName = nameMatch[1];
        }

        // Try to find ranking line
        const rankingMatch = line.match(/^(\s*)"ranking":\s*(\d+),/);
        if (rankingMatch) {
            const indent = rankingMatch[1];
            const currentRank = parseInt(rankingMatch[2]);

            // Determine new rank
            let newRank = currentRank;

            // Only update if current rank is 0 or we want to enforce canonical mapping
            if (RANKING_MAP[currentUniName]) {
                newRank = RANKING_MAP[currentUniName];
            } else if (currentRank === 0) {
                // Assign a Tier 2 rank if no specific map exists and currently 0
                newRank = nextRank++;
            }

            // Construct new line
            updatedLines.push(`${indent}"ranking": ${newRank},`);
            updatesCount++;
        } else {
            updatedLines.push(line);
        }
    }

    const newContent = updatedLines.join('\n');
    fs.writeFileSync(UNIV_FILE_PATH, newContent, 'utf-8');

    console.log(`‚úÖ Updated rankings for ${updatesCount} universities.`);
}

updateRankings();
